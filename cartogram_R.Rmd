---
title: "Cartograma"
subtitle: "Tasa de embarazo adolecente en Sudamérica
knit: (function(input_file, encoding) {
    out_dir <- 'docs';
    rmarkdown::render(input_file,
      encoding=encoding,
      output_file=file.path(dirname(input_file), out_dir, 'index.html'))})
output:
html_document:
df_print: paged
---

Este proyecto ha sido realizado en base a los pasos descritos en la página siguiente:

https://cran.r-project.org/web/packages/cartogram/readme/README.html

```{r}
#Librerías necesarias

library(cartogram)
library(tmap)
library(maptools)
library(sf)
```

```{r}
#Cargamos la información de los polígonos espaciales de los mapas
data(wrld_simpl)
```

```{r}
# Cargamos las variables que vamos a graficar

covid_data <- read.csv("covid_sudamerica.csv", sep = ";", header = TRUE)

#https://www.unfpa.org/modules/custom/unfpa_global_sowp_portal/data-file/SWOP-Data-2022.xlsx
```

```{r}
# Filtramos la subregion Sudamérica
sud_ame <- wrld_simpl[wrld_simpl$SUBREGION == 5, ]
```

```{r}
#Unimos los polígonos con la información
sud_ame <- merge(sud_ame,covid_data,by="NAME")
```

```{r}
# Proyectamos el mapa                                   
sud_ame <- spTransform(sud_ame, CRS("+init=epsg:31972"))

# Construimos el cartograma
sud_ame_cont <- cartogram_cont(sud_ame, "numero", itermax = 4)

# Dibujamos el mapa continuo
tm_shape(sud_ame_cont) + tm_polygons("numero", style = "jenks") +
  tm_layout(frame = FALSE, main.title = "Tasa de embarazo adolescente en Sudamérica", legend.position = c("left", "bottom"), main.title.size= 1)
```

```{r}
# Dibujamos el mapa no continuo
sud_ncont <- cartogram_ncont(sud_ame, "numero")
tm_shape(sud_ame) + tm_borders() +
  tm_shape(sud_ncont) + tm_polygons("numero", style = "jenks") +
  tm_layout(frame = FALSE, main.title = "Tasa de embarazo adolescente en Sudamérica", legend.position = c("left", "bottom"), main.title.size= 1)
```

